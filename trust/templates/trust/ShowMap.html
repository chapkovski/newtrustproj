{% extends "global/Page.html" %}
{% load otree i18n hse %}

{% block title %}
    {% trans 'Map of all cities that participate in the study.' %}
{% endblock %}

{% block content %}
    <div class="card my-3">
        <div class="card-body">
            On this map you can see all 12 cities which participate in this study. This map is always available to you
            in the course of the study
            if you click on the button 'Show map' at the right top corner.

        </div>
    </div>

      <style>
                    /* Always set the map height explicitly to define the size of the div
                       * element that contains the map. */
                    #template_map {
                        min-height: 400px;


                    }

                    /* Optional: Makes the sample page fill the window. */
                    html,
                    body {
                        height: 100%;
                        margin: 0;
                        padding: 0;
                    }

                    /* The popup bubble styling. */
                    .popup-bubble {
                        /* Position the bubble centred-above its parent. */
                        position: absolute;
                        top: 0;
                        left: 0;
                        transform: translate(-50%, -100%);
                        /* Style the bubble. */
                        background-color: white;
                        padding: 5px;
                        border-radius: 5px;
                        font-family: sans-serif;
                        overflow-y: auto;
                        max-height: 60px;
                        font-weight: bold;
                        font-size: 1rem;
                        box-shadow: 0px 2px 10px 1px rgba(0, 0, 0, 0.5);
                    }

                    /* The parent of the bubble. A zero-height div at the top of the tip. */
                    .popup-bubble-anchor {
                        /* Position the div a fixed distance above the tip. */
                        position: absolute;
                        width: 100%;
                        bottom: /* TIP_HEIGHT= */ 8px;
                        left: 0;
                    }

                    /* This element draws the tip. */
                    .popup-bubble-anchor::after {
                        content: "";
                        position: absolute;
                        top: 0;
                        left: 0;
                        /* Center the tip horizontally. */
                        transform: translate(-50%, 0);
                        /* The tip is a https://css-tricks.com/snippets/css/css-triangle/ */
                        width: 0;
                        height: 0;
                        /* The tip is 8px high, and 12px wide. */
                        border-left: 6px solid transparent;
                        border-right: 6px solid transparent;
                        border-top: /* TIP_HEIGHT= */ 8px solid white;
                    }

                    /* JavaScript will position this div at the bottom of the popup tip. */
                    .popup-container {
                        cursor: auto;
                        height: 0;
                        position: absolute;
                        /* The max width of the info window. */
                        width: 200px;
                    }
                </style>
                <div id="template_map" class="map" ></div>



{#                <script>   console.debug('HERE')#}
{#                    var map1, popup1, Popup1;#}
{##}
{#                    /** Initializes the map and the custom popup. */#}
{#                    function initMapInTemplate() {#}
{#                        console.debug('nit map loaded')#}
{#                        map1 = new google.maps.Map(document.getElementById("template_map"), {#}
{#                            // 61.5240° N, 105.3188° E#}
{#                            center: {lat: 59.524, lng: 90.3188},#}
{#                            zoom: 3,#}
{#                            gestureHandling: "none",#}
{#                            zoomControl: false,#}
{#                            disableDefaultUI: true,#}
{#                            styles: [#}
{##}
{#                                {#}
{#                                    featureType: "landscape",#}
{#                                    stylers: [{visibility: "off"}]#}
{#                                },#}
{#                                {#}
{#                                    featureType: "road",#}
{#                                    stylers: [{visibility: "off"}]#}
{#                                },#}
{##}
{#                                {#}
{#                                    featureType: "poi",#}
{#                                    stylers: [{visibility: "off"}]#}
{#                                },#}
{##}
{#                            ]#}
{#                        });#}
{#                        map.setZoom(3.2);#}
{#                        Popup = createPopupClass();#}
{#                        popup = new Popup(#}
{#                            new google.maps.LatLng(55.7558, 37.6173),#}
{#                            document.getElementById("content")#}
{#                        );#}
{#                        popup2 = new Popup(#}
{#                            new google.maps.LatLng(58.9092, 57.927),#}
{#                            document.getElementById("perm")#}
{#                        );#}
{#                        popup3 = new Popup(#}
{#                            new google.maps.LatLng(56.8431, 60.6454),#}
{#                            document.getElementById("ekat")#}
{#                        );#}
{#                        novosPopup = new Popup(#}
{#                            new google.maps.LatLng(54.9833, 82.8964),#}
{#                            document.getElementById("novos")#}
{#                        );#}
{#                        kazanPopup = new Popup(#}
{#                            new google.maps.LatLng(54.7879, 49.1233),#}
{#                            document.getElementById("kazan")#}
{#                        );#}
{#                        rostovPopup = new Popup(#}
{#                            new google.maps.LatLng(47.2357, 39.7015),#}
{#                            document.getElementById("rostov")#}
{#                        );#}
{#                        voronPopup = new Popup(#}
{#                            new google.maps.LatLng(51.6683, 39.1919),#}
{#                            document.getElementById("voron")#}
{#                        );#}
{#                        makhPopup = new Popup(#}
{#                            new google.maps.LatLng(42.9778, 47.5147),#}
{#                            document.getElementById("makh")#}
{#                        );#}
{#                        arkPopup = new Popup(#}
{#                            new google.maps.LatLng(64.5459, 40.5506),#}
{#                            document.getElementById("ark")#}
{#                        );#}
{#                        vladikPopup = new Popup(#}
{#                            new google.maps.LatLng(43.1332, 131.9113),#}
{#                            document.getElementById("vladik")#}
{#                        );#}
{##}
{#                        popup.setMap(map);#}
{#                        popup2.setMap(map);#}
{#                        popup3.setMap(map);#}
{#                        novosPopup.setMap(map);#}
{#                        kazanPopup.setMap(map);#}
{#                        rostovPopup.setMap(map);#}
{#                        voronPopup.setMap(map);#}
{#                        makhPopup.setMap(map);#}
{#                        vladikPopup.setMap(map);#}
{#                        arkPopup.setMap(map);#}
{#                    }#}
{##}
{#                    /**#}
{#                     * Returns the Popup class.#}
{#                     *#}
{#                     * Unfortunately, the Popup class can only be defined after#}
{#                     * google.maps.OverlayView is defined, when the Maps API is loaded.#}
{#                     * This function should be called by initMap.#}
{#                     */#}
{#                    function createPopupClass() {#}
{#                        /**#}
{#                         * A customized popup on the map.#}
{#                         * @param {!google.maps.LatLng} position#}
{#                         * @param {!Element} content The bubble div.#}
{#                         * @constructor#}
{#                         * @extends {google.maps.OverlayView}#}
{#                         */#}
{#                        function Popup(position, content) {#}
{#                            this.position = position;#}
{##}
{#                            content.classList.add("popup-bubble");#}
{##}
{#                            // This zero-height div is positioned at the bottom of the bubble.#}
{#                            var bubbleAnchor = document.createElement("div");#}
{#                            bubbleAnchor.classList.add("popup-bubble-anchor");#}
{#                            bubbleAnchor.appendChild(content);#}
{##}
{#                            // This zero-height div is positioned at the bottom of the tip.#}
{#                            this.containerDiv = document.createElement("div");#}
{#                            this.containerDiv.classList.add("popup-container");#}
{#                            this.containerDiv.appendChild(bubbleAnchor);#}
{##}
{#                            // Optionally stop clicks, etc., from bubbling up to the map.#}
{#                            google.maps.OverlayView.preventMapHitsAndGesturesFrom(this.containerDiv);#}
{#                        }#}
{##}
{#                        // ES5 magic to extend google.maps.OverlayView.#}
{#                        Popup.prototype = Object.create(google.maps.OverlayView.prototype);#}
{##}
{#                        /** Called when the popup is added to the map. */#}
{#                        Popup.prototype.onAdd = function () {#}
{#                            this.getPanes().floatPane.appendChild(this.containerDiv);#}
{#                        };#}
{##}
{#                        /** Called when the popup is removed from the map. */#}
{#                        Popup.prototype.onRemove = function () {#}
{#                            if (this.containerDiv.parentElement) {#}
{#                                this.containerDiv.parentElement.removeChild(this.containerDiv);#}
{#                            }#}
{#                        };#}
{##}
{#                        /** Called each frame when the popup needs to draw itself. */#}
{#                        Popup.prototype.draw = function () {#}
{#                            var divPosition = this.getProjection().fromLatLngToDivPixel(this.position);#}
{##}
{#                            // Hide the popup when it is far out of view.#}
{#                            var display =#}
{#                                Math.abs(divPosition.x) < 4000 && Math.abs(divPosition.y) < 4000#}
{#                                    ? "block"#}
{#                                    : "none";#}
{##}
{#                            if (display === "block") {#}
{#                                this.containerDiv.style.left = divPosition.x + "px";#}
{#                                this.containerDiv.style.top = divPosition.y + "px";#}
{#                            }#}
{#                            if (this.containerDiv.style.display !== display) {#}
{#                                this.containerDiv.style.display = display;#}
{#                            }#}
{#                        };#}
{##}
{#                        return Popup;#}
{#                    }#}
{#                </script>#}


    <h5 class="my-3">The cities that participate in the study are the following:</h5>
    <table class="table">
        <tbody>
        {% for foo in cities %}
            <tr>
                <td>{{ foo.description }}</td>
            </tr>
        {% endfor %}

        </tbody>
    </table>
    {% next_button %}

{% endblock %}
